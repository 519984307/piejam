add_library(piejam_runtime STATIC
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/add_bus.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/add_internal_fx_module.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/add_ladspa_fx_module.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/apply_app_config.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/delete_bus.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/delete_fx_module.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/device_action.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/device_action_visitor.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/engine_action.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/engine_action_visitor.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/finalize_ladspa_fx_plugin_scan.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/fwd.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/initiate_device_selection.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/load_ladspa_fx_plugin.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/refresh_devices.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/renotify.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/request_info_update.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/request_levels_update.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/request_mixer_levels_update.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/scan_ladspa_fx_plugins.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/select_bus_channel.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/select_device.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/select_fx_chain_bus.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/select_period_size.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/select_samplerate.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/set_bool_parameter.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/set_bus_mute.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/set_bus_name.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/set_bus_pan_balance.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/set_bus_solo.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/set_bus_volume.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/set_float_parameter.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/set_float_parameter_normalized.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/update_devices.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/update_info.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/actions/update_levels.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/app_config.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/audio_engine.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/audio_engine_middleware.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/audio_state.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/channel_index_pair.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/components/fx_gain.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/components/fx_ladspa.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/components/mixer_bus.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/components/mute_solo.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/config_access.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/fwd.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/fx/fwd.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/fx/gain.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/fx/internal.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/fx/ladspa.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/fx/ladspa_manager.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/fx/ladspa_processor_factory.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/fx/module.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/fx/parameter.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/fx/registry.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/locations.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/mixer.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/mixer_fwd.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/open_alsa_device.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/parameter/float_.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/parameter/float_normalize.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/parameter/fwd.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/parameter/generic_value.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/parameter/int_.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/parameter/map.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/parameter_processor_factory.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/parameters.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/processors/fwd.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/processors/mute_solo_processor.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/processors/parameter_input_processor_factory.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/processors/parameter_output_processor_factory.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/processors/parameter_processor_factory.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/selected_device.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/selectors.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/stereo_level.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/store.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/store_dispatch.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/subscriber.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/ui/action.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/ui/action_visitor.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/ui/cloneable_action.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/ui/fwd.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/ui/thunk_action.h
    ${CMAKE_CURRENT_SOURCE_DIR}/include/piejam/runtime/ui/thunk_action_impl.h
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/add_bus.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/add_internal_fx_module.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/add_ladspa_fx_module.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/apply_app_config.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/delete_bus.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/delete_fx_module.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/finalize_ladspa_fx_plugin_scan.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/initiate_device_selection.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/load_ladspa_fx_plugin.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/refresh_devices.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/renotify.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/request_info_update.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/request_levels_update.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/request_mixer_levels_update.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/scan_ladspa_fx_plugins.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/select_bus_channel.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/select_device.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/select_fx_chain_bus.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/select_period_size.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/select_samplerate.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/set_bool_parameter.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/set_bus_mute.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/set_bus_name.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/set_bus_pan_balance.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/set_bus_solo.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/set_bus_volume.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/set_float_parameter.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/set_float_parameter_normalized.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/update_devices.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/update_info.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/actions/update_levels.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/app_config.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/audio_engine.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/audio_engine_middleware.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/audio_state.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/components/fx_gain.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/components/fx_ladspa.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/components/mixer_bus.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/components/mute_solo.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/config_access.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/fx/gain.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/fx/ladspa.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/fx/ladspa_manager.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/open_alsa_device.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/processors/mute_solo_processor.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/selectors.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/store_dispatch.cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src/piejam/runtime/thunk_action.cpp
)

find_package(nlohmann_json REQUIRED)

target_compile_options(piejam_runtime PRIVATE -Wall -Wextra -Werror -pedantic-errors)
target_include_directories(piejam_runtime PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/include)
target_link_libraries(piejam_runtime
    PUBLIC
    piejam_redux
    piejam_numeric
    piejam_thread
    piejam_audio
    piejam_functional
    piejam_container
    piejam_reselect
    nlohmann_json
    PRIVATE
    fmt
    spdlog::spdlog
    piejam_algorithm
    piejam_range)

add_subdirectory(benchmarks)
add_subdirectory(tests)
